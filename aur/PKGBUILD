# Maintainer: Midori AI Maintainers <midoriaidev@gmail.com>
# This PKGBUILD uses uv exclusively; do not invoke system python.
pkgname=midori-ai-hello
pkgver=0.1.0
pkgrel=1
pkgdesc="Vision TUI that trains YOLO models and manages KDE screen lock"
arch=('any')
url="https://github.com/Midori-AI-OSS/Midori-AI-Hello"
license=('MIT')
depends=('uv')
_commit=38d3ee46cf79539e7d97f05aec9c1b2430b48ee9
source=("$pkgname-$pkgver.tar.gz::$url/archive/$_commit.tar.gz")
sha256sums=('017b3314baf65b19b104f518e6206f18494cf8b5dc36a4be6666a17c3b692a41')

pkgver() {
  cd "Midori-AI-Hello-$_commit"
  grep -Po '(?<=^version = ")[^"]+' pyproject.toml
}

build() {
  cd "Midori-AI-Hello-$_commit"
  uv build --wheel
}

package() {
  cd "Midori-AI-Hello-$_commit"
  uv pip install --compile-bytecode --prefix="$pkgdir/usr" dist/*.whl
  install -Dm755 /dev/stdin "$pkgdir/usr/bin/midori-ai-hello" <<'EOT'
#!/usr/bin/env sh
exec uv run -m midori_ai_hello "$@"
EOT
}
